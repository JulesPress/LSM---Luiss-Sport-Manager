{% extends 'app/base.html' %}

{% block title %}My Certificates - LUISS Rowing{% endblock %}

{% block content %}
<h1 class="page-title">üìã My Certificates</h1>

<div class="card" style="margin-bottom: 30px;">
    <form method="GET" style="display: flex; gap: 15px; flex-wrap: wrap;">
        <div style="flex: 1; min-width: 200px;">
            <select name="type" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 5px;">
                <option value="">All Types</option>
                {% for value, label in cert_types %}
                <option value="{{ value }}" {% if cert_type == value %}selected{% endif %}>{{ label }}</option>
                {% endfor %}
            </select>
        </div>
        <div style="flex: 1; min-width: 200px;">
            <select name="status" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 5px;">
                <option value="">All Status</option>
                <option value="valid" {% if status_filter == 'valid' %}selected{% endif %}>Valid</option>
                <option value="expiring" {% if status_filter == 'expiring' %}selected{% endif %}>Expiring Soon</option>
                <option value="expired" {% if status_filter == 'expired' %}selected{% endif %}>Expired</option>
            </select>
        </div>
        <button type="submit" class="btn btn-secondary">üîç Filter</button>
    </form>
</div>

{% if certificates %}
<div class="grid" style="grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));">
    {% for cert in certificates %}
    <div class="card">
        <img src="{{ cert.certificate_image.url }}" alt="Certificate" style="width: 100%; height: 200px; object-fit: cover; border-radius: 5px; margin-bottom: 15px;">
        
        <h3 style="color: var(--primary); margin-bottom: 10px;">{{ cert.get_certificate_type_display }}</h3>
        
        <p style="margin: 5px 0;"><strong>Issued:</strong> {{ cert.issue_date }}</p>
        <p style="margin: 5px 0;"><strong>Expires:</strong> {{ cert.expiry_date }}</p>
    
        
        <div style="margin-top: 15px;">
            {% if cert.is_expired %}
            <span class="status-badge status-expired">Expired</span>
            {% elif cert.is_expiring_soon %}
            <span class="status-badge status-expiring">Expiring Soon</span>
            {% else %}
            <span class="status-badge status-valid">Valid</span>
            {% endif %}
        </div>
        
        <div class="actions" style="margin-top: 15px;">
            <a href="{% url 'certificate_detail' cert.id %}" class="btn btn-secondary btn-sm">View</a>
        </div>
    </div>
    {% endfor %}
</div>
{% else %}
<div class="card">
    <p style="text-align: center; color: #999;">No certificates found. <a href="{% url 'certificate_upload' %}">Upload one</a></p>
</div>
{% endif %}

<div style="text-align: center; margin-top: 30px;">
    <a href="{% url 'certificate_upload' %}" class="btn btn-primary">üì§ Upload New Certificate</a>
</div>
{% endblock %}